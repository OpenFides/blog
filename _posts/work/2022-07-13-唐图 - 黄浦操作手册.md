# 黄浦项目操作手册

## 唐图的安装升级

首先，安装.net framework 4.6.2、唐图、融合通讯、三维地图和相关软件（参考快速部署）
然后，将公安专用硬盘中的文件copy到目标机器的D盘。（建议把其它应用文件也放进来，统一管理）

## TG文件修改

各派出所电脑上的TG文件修改如下：

```js
tg.open("http://15.112.168.136:8085","wired","ie","left=-2000,top=10000,width=500,height=400","MainForm");

tg.open("http://15.112.168.136:8086","map3d","@ie","left=10,top=-2000,width=960,height=740","empty");

//如果希望全屏打开主界面
//tg.run("D:\\Program\\msedge\\msedge.exe","--kiosk https://15.112.168.132/?_title=mainBox#/login");
//使用常规方式打开主界面，相当于点击一个链接
tg.run("D:\\Program\\msedge\\msedge.exe","https://15.112.168.132/?_title=mainBox#/login");
```

## 显示三维地图到浏览器之上

在需要显示三维地图的事件中使用以下代码： 

```js
tg.find("map3d").position(x,y).show(docment.title);	//position为可选项
```

注： docment.title是得到当前浏览器的标题（可以自行定义，但不推荐）

## 运行与关闭外部程序

首先，前端需要更新tg.js文件（在唐图的安装目录中）

然后，使用以下代码运行一个外部程序：

```js
tg.run("d:\\path\app.exe","#myname# args...");
```

最后，使用以下代码关闭这个外部程序：

```
tg.kill("myname"); //myname由上一步骤定义
```

## 注意事项

1. 前端需要更新唐图JDK（tg.js）

2. 前端登录首页（https://15.112.168.132/?_title=mainBox#/login）需要优化（目前需要5s以上才能打开）
3. 应用的主屏为微软的edge浏览器，此浏览器不建议其它程序使用，以避免相互冲突
4. 建议项目补充完成快速部署手册（我发现项目部署人员 - 蔡永龙 - 对系统有哪几个部分都不知道，更不要说如何检查软件安装了）
5. 唐图主要服务于大屏应用，黄浦现在是态势 + 指挥系统。建议：项目需要为不同分辨下定制显示解决方案（可以通过URL参数实现不同分辨率的定制切换）

## 附：快速部署

1. 安装.net freamwork 4.6.2
2. 安装唐图setup.exe
3. copy Program 到 本机（建议把其它程序也放到Program中）
4. 安装skyline(先检查一下操作系统是不是64位)
5. 检查IE版本(如果非IE11，安装)
6. 确认操作系统使用的是64位（通过安装包的注册表修改）
7. 重启电脑（如果涉及#1，#5，#6的操作）
8. 打开浏览器输入map3d的地址确认安装无误
9. 双击xxx.tg文件运行唐图（xxx为各派出所的项目名）

