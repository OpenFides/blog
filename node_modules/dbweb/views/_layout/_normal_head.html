<!DOCTYPE html>
<html>

<head>
	<title>{{.ProjectLabel}} - {{.Element.DisplayLabel}} [{{.User.Name}}]</title>
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no" />
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
	[[$files := newFiles]]
	[[append $files "/flib/bootstrapc/css/bootstrap.css" "/flib/bootstrapc/css/bootstrap.min.css"]]
	[[append $files "/flib/bootstrapc/css/bootstrap-theme.css" "/flib/bootstrapc/css/bootstrap-theme.min.css"]]
	[[append $files "/flib/jasny-bootstrap/dist/css/jasny-bootstrap.css" "/flib/jasny-bootstrap/dist/css/jasny-bootstrap.min.css"]]
	[[append $files "/flib/font-awesome/css/font-awesome.css" "/flib/font-awesome/css/font-awesome.min.css"]]
	[[append $files "/flib/font-awesome-animation/dist/font-awesome-animation.css" "/flib/font-awesome-animation/dist/font-awesome-animation.min.css"]]
	[[append $files "/flib/awesome-bootstrap-checkbox/awesome-bootstrap-checkbox.css"]]
	[[append $files "_normal_head.css"]]
	<link rel="stylesheet" type="text/css" href="[[concat $files]]">
	<!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
	<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
	[[$files := newFiles]]
	[[append $files "/flib/html5shiv/dist/html5shiv.js" "/flib/html5shiv/dist/html5shiv.min.js"]]
	[[append $files "/flib/respond/dest/respond.src.js" "/flib/respond/dest/respond.min.js"]]
	<!--[if lt IE 9]>
        <script src="[[concat $files]]"></script>
	<![endif]-->
</head>
<body>
	[[$files := newFiles]]
	[[append $files "/flib/underscore/underscore.js" "/flib/underscore/underscore-min.js"]]
	[[append $files "/flib/jquery/dist/jquery.js" "/flib/jquery/dist/jquery.min.js"]]
	[[append $files "/flib/JSON-js/json2.js"]]
	[[append $files "/flib/bootstrapc/js/bootstrap.js" "/flib/bootstrapc/js/bootstrap.min.js"]]
	[[append $files "/flib/jasny-bootstrap/dist/js/jasny-bootstrap.js" "/flib/jasny-bootstrap/dist/js/jasny-bootstrap.min.js"]]
	[[append $files "/flib/reconnectingWebsocket/reconnecting-websocket.js" "/flib/reconnectingWebsocket/reconnecting-websocket.min.js"]]
	[[append $files "/flib/waitdialog/waitdialog.js"]]
	[[append $files "_normal_head.js"]]
	
	<script src="[[concat $files]]" type="text/javascript" charset="utf-8"></script>
	<nav id="myNavmenu" class="navmenu navmenu-default navmenu-fixed-left offcanvas" role="navigation">
		<a class="navmenu-brand" href="#"><i class="fa fa-user"></i> {{.User.Name}} {{.User.Dept.Code}}.{{.User.Dept.Name}}{{if $status:=.LSession.Get "$title_status"}}({{$status}}){{end}}</a>
		<ul class="nav navmenu-nav">
			<li class="dropdown">
				<a href="#" class="dropdown-toggle">切换处理地 <b class="caret"></b></a>
				<ul class="dropdown-menu navmenu-nav" role="menu">
					<li><a href="/setdept?next={{.Req.URL.String}}"><i class="fa fa-group"></i>指定处理地</a></li>
					{{range .User.NextLevelDept}}
					<li><a href='{{.SwitchUrl $.Req}}' data-showwaiting>{{.Code}}.{{.Name}}</a></li>
					{{end}}{{range .User.ToRootDept}}
					<li><a href='{{.SwitchUrl $.Req}}' data-showwaiting>{{.Code}}.{{.Name}}</a></li>
					{{end}}
				</ul>
			</li>

			{{range $index0,$Cate0 :=.User.MenuCategory0}}
			<li class="dropdown">
				<a href="#" class="dropdown-toggle">{{$Cate0.ClearText}} <b class="caret"></b></a>
				<ul class="dropdown-menu navmenu-nav" role="menu">
					{{range $indexm,$menu :=$.User.Menus $Cate0.Name}}
					<li><a href="{{$menu.Url}}"{{if not $menu.NewWindow}} data-showwaiting{{end}} data-elementname={{$menu.ElementName}} {{if $menu.NewWindow}} target="_blank" {{end}}><i class="fa fa-angle-right" aria-hidden="true"></i>&nbsp;{{$menu.ClearLabel}}</a></li>
					{{end}}
					{{range $index1,$Cate1 :=$.User.MenuCategory1 $Cate0.Name}}
					<li class="dropdown-header">{{$Cate1.ClearText}}</li>
					{{range $indexm,$menu :=$.User.Menus $Cate0.Name $Cate1.Name}}
					<li><a href="{{$menu.Url}}"{{if not $menu.NewWindow}} data-showwaiting{{end}} data-elementname={{$menu.ElementName}} {{if $menu.NewWindow}} target="_blank" {{end}}><i class="fa fa-angle-right" aria-hidden="true"></i>&nbsp;{{$menu.ClearLabel}}</a></li>
					{{end}} {{end}}
				</ul>
			</li>
			{{end}}
			<li><a href="/logout"><i class="fa fa-sign-out"></i>退出系统</a></li>
		</ul>
	</nav>
	<div id="divEmptyTitle"></div>
	<div id="navTitle" class="navbar navbar-inverse navbar-static-top">
		<button type="button" class="navbar-toggle" data-toggle="offcanvas" data-target="#myNavmenu" data-canvas="body">
			<span class="icon-bar"></span>
			<span class="icon-bar"></span>
			<span class="icon-bar"></span>
		</button>
		<p class="navbar-text">
			<a href="javascript:void(0)" id="btnPushPin" class="navbar-link"><i class="fa fa-thumb-tack" aria-hidden="true"></i></a>
			<span id="topSubTitle">{{range $i,$v :=.Element.ClearCategory}}{{$v}}->{{end}}{{.Element.DisplayLabel}}</span> {{template "helpicon" .}}
			<a href="javascript:void(0)" id="btnMsgIcon" class="navbar-link"><i id="iMsgIcon" class="fa fa-fw fa-envelope-o faa-shake"></i> <span id="spnMsgCount" class='msg_count'>0</span></a>
		</p>
		<ul class="nav navbar-nav navbar-right" id="ulRightTop">
			<li>
				<a href="javascript:void(0)" data-toggle="dropdown"><i class="fa fa-user"></i> {{.User.Name}} {{.User.Dept.Code}}.{{.User.Dept.Name}}{{if $status:=.LSession.Get "$title_status"}}({{$status}}){{end}}</a>
				<ul class="dropdown-menu">
					<li><a href="/setdept?next={{.Req.URL.String}}" data-showwaiting><i class="fa fa-group"></i>指定处理地</a></li>
					<li><a href="/logout"><i class="fa fa-sign-out" data-showwaiting></i>退出系统</a></li>
					{{if .User.NextLevelDept}}
					<li class="divider"></li>
					{{end}}
					{{range .User.NextLevelDept}}
					<li><a href='{{.SwitchUrl $.Req}}' data-showwaiting>{{.Code}}.{{.Name}}</a></li>
					{{end}}
					{{if .User.ToRootDept}}
					<li class="divider"></li>
					{{end}}
					{{range .User.ToRootDept}}
					<li><a href='{{.SwitchUrl $.Req}}' data-showwaiting>{{.Code}}.{{.Name}}</a></li>
					{{end}}
				</ul>
			</li>
			<li id="liVersion">
				<a href="/version" target="_blank" id="btnVersion">Ver:{{version}}</a>
			</li>
		</ul>
	</div>
	<div id="divMessage">
		<div id="divMessageBoard" class="message">
		</div>
		<div class="form-group">
			<div class="input-group">
				<div class="input-group-addon">消息:</div>
				<input id="edtMessage" class="form-control" type="text" placeholder="请输入消息">
				<span class="input-group-btn">
			    	<button id="btnSend" class="btn btn-default" type="button" disabled="disabled">发送</button>
			    </span>
			</div>
		</div>
	</div>
	<script>
		initHead({{.Element.Name}},{{.User.Name}},{{.Req.RemoteAddr}});
	</script>