package server

import (
	"dbweb/core"
	"dbweb/lib/zip"
	"log"
	"os"

	"github.com/linlexing/dbx"
)

const (
	PUBLIC_PATH = "public"
	VIEW_PATH   = "views"
)

func importInstitution(fileName string, db dbx.DB) error {
	outFile, err := core.CreateTempFile("imp_")
	if err != nil {
		return err
	}
	outFileName := outFile.Name()
	if err = outFile.Close(); err != nil {
		return err
	}
	defer os.Remove(outFileName)
	if err = zip.UnzipFile(fileName, "dump.sl3", outFileName); err != nil {
		return err
	}
	return core.RestoreFile(outFileName, "institution", nil, db, core.NewUser(db, "sys"), func(message string) {
		log.Println(message)
	})

}

func RunServer(port []int) error {

}
