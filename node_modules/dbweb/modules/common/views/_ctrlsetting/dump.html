{{with $param :=.More.JSONParams}}
<style type="text/css">
	.control-label{
		padding:0px;
	}
	.sql{ 
		border:1px solid #ccc;
		height:150px;
		font-size:13px;
	}
</style>
<form class="form-horizontal" id="dump_param_setting" data-bill-fieldname="PARAMS" >
	<div class="form-group">
		<label class="control-label col-md-1" for="edtDumpName" class="control-label">Dump名称:</label>
		<div class="col-md-5">
			<input id="edtDumpName" type="text" class="form-control" value="{{.Name}}" {{if ($.Field "PARAMS").Readonly}}readonly="readonly"{{end}}>
		</div>
		<label class="control-label col-md-1" for="edtDumpName" class="control-label">文件名:</label>
		<div class="col-md-5">
			<input id="edtOutFileName" type="text" class="form-control" value="{{.OutFileName}}" {{if ($.Field "PARAMS").Readonly}}readonly="readonly"{{end}}>
		</div>
	</div>
	<div class="form-group">
		<label class="control-label col-md-1" for="edtBeforeSQL" class="control-label">Before:</label>
		<div class="col-md-11">
			<div id="edtBeforeSQL" class="sql">{{.BeforeSQL}}</div>
		</div>
	</div>
	<div class="form-group">
		<label class="control-label col-md-1" for="edtAfterSQL" class="control-label">After:</label>
		<div class="col-md-11">
			<div id="edtAfterSQL" class="sql" >{{.AfterSQL}}</div>
		</div>
	</div>
</form>
<script>
var edtBeforeSQL = ace.edit($("#edtBeforeSQL")[0]);
edtBeforeSQL.setTheme("ace/theme/sqlserver");
edtBeforeSQL.getSession().setMode("ace/mode/sql");
{{if ($.Field "PARAMS").Readonly}}edtBeforeSQL.setReadOnly(true);{{end}}

var edtAfterSQL = ace.edit($("#edtAfterSQL")[0]);
edtAfterSQL.setTheme("ace/theme/sqlserver");
edtAfterSQL.getSession().setMode("ace/mode/sql");
{{if ($.Field "PARAMS").Readonly}}edtAfterSQL.setReadOnly(true);{{end}}

/*******************************************************/
$("#dump_param_setting").data("oncollection",function(){
	return JSON.stringify({
		Name:$("#edtDumpName").val(),
		OutFileName:$("#edtOutFileName").val(),
		BeforeSQL:aceTrimTrailingSpace(edtBeforeSQL),
		AfterSQL:aceTrimTrailingSpace(edtAfterSQL)
	},null,"\t");
})
</script>
{{end}}
