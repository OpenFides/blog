<script src="/js/ace/ace.js" type="text/javascript" charset="utf-8"></script>
<script src="/aceTrimTrailingSpace/aceTrimTrailingSpace.js" type="text/javascript" charset="utf-8"></script>

<style>
.sql-editor {
	border: 1px solid #ccc; 
	font-size:13px;
	height:150px;
}
</style>
<form  class="form-horizontal">
	<div class="form-group">
		<label for="fldDUMPNAME" class="control-label col-md-1 bill-label">数据包名:</label>
		<div class="col-md-5">
		{{template "_bill/input" (.Field "DUMPNAME")}}
		</div>
		<label for="fldBILLNAME" class="control-label col-md-1 bill-label">单据名:</label>
		<div class="col-md-5">
		{{template "_bill/input" (.Field "BILLNAME")}}
		</div>
	</div>
	<div class="form-group">
		<label for="fldDBNAME" class="control-label col-md-1 bill-label">数据库:</label>
		<div class="col-md-5">
		{{template "_bill/select" (.Field "DBNAME")}}
		</div>
		<label for="fldDEPT" class="control-label col-md-1 bill-label">部门代码:</label>
		<div class="col-md-5">
		{{template "_bill/input" (.Field "DEPT")}}
		</div>
	</div>
	<div class="form-group">
		<label for="fldTABLENAMES" class="control-label col-md-1 bill-label">表名:</label>
		<div class="col-md-5">
		{{template "_bill/input" (.Field "TABLENAMES")}}
		</div>
		<label for="fldACTIONEXISTS" class="control-label col-md-1 bill-label">记录存在:</label>
		<div class="col-md-5">
		{{template "_bill/radiobutton" (.Field "ACTIONEXISTS")}}
		</div>
	</div>
	<div class="form-group">
		<label for="fldSQLWHERE" class="control-label col-md-1 bill-label">Where:</label>
		<div class="col-md-11">
			<div id="fldSQLWHERE" class="bill-field sql-editor" data-bill-fieldname="SQLWHERE">{{(.Field "SQLWHERE").Value}}</div>
		</div>
	</div>
	<div class="form-group">
		<label for="fldSQLBEFORE" class="control-label col-md-1 bill-label">Before:</label>
		<div class="col-md-11">
			<div id="fldSQLBEFORE" class="bill-field sql-editor" data-bill-fieldname="SQLBEFORE">{{(.Field "SQLBEFORE").Value}}</div>
		</div>
	</div>
	<div class="form-group">
		<label for="fldSQLAFTER" class="control-label col-md-1 bill-label">After:</label>
		<div class="col-md-11">
			<div id="fldSQLAFTER" class="sql-editor bill-field" data-bill-fieldname="SQLAFTER">{{(.Field "SQLAFTER").Value}}</div>
		</div>
	</div>
</form>
<script>
var edtWhereSql = ace.edit("fldSQLWHERE");
edtWhereSql.setTheme("ace/theme/sqlserver");
edtWhereSql.getSession().setMode("ace/mode/sql");
edtWhereSql.$blockScrolling = Infinity;
{{if ($.Field "SQLWHERE").Readonly}}edtWhereSql.setReadOnly(true);{{end}}

var edtBeforeSql = ace.edit("fldSQLBEFORE");
edtBeforeSql.setTheme("ace/theme/sqlserver");
edtBeforeSql.getSession().setMode("ace/mode/sql");
edtBeforeSql.$blockScrolling = Infinity;
{{if ($.Field "SQLBEFORE").Readonly}}edtBeforeSql.setReadOnly(true);{{end}}

var edtAfterSql = ace.edit("fldSQLAFTER");
edtAfterSql.setTheme("ace/theme/sqlserver");
edtAfterSql.getSession().setMode("ace/mode/sql");
edtAfterSql.$blockScrolling = Infinity;
{{if ($.Field "SQLAFTER").Readonly}}edtAfterSql.setReadOnly(true);{{end}}

$("#fldSQLWHERE").data("oncollection",function(){
	return aceTrimTrailingSpace(edtWhereSql);
});
$("#fldSQLBEFORE").data("oncollection",function(){
	return aceTrimTrailingSpace(edtBeforeSql);
});
$("#fldSQLAFTER").data("oncollection",function(){
	return aceTrimTrailingSpace(edtAfterSql);
});
</script>