<style type="text/css">
	body{
		background-color:dimgray;
	}
	.panDump{
		max-width:700px;
		margin-left:auto;
		margin-right:auto;
	}
	.panel-footer{
		text-align:right;
	}
</style>
<form role="form" action="{{.Req.URL.String}}" method="POST">
<div class="container">
	<div class="panel panel-default panDump">
		<div class="panel-heading">
			<h3 class="panel-title">{{.Element.DisplayLabel}}</h3>
		</div>
		<div class="panel-body">
			<p>要导出的部门代码:{{.User.Dept.Code}}
			</p>
			<p class="help-block">
				请选择要导出的单据
			</p>
			<table id="tabBill" class="table table-hover table-striped">
				<thead>
					<th style="width:20%">序号</th>
					<th style="width:40%">名称</th>
					<th style="width:40%">物理表</th>
				</thread>
				<tbody>
				{{range $idx,$bill :=.More.Params.Bills}}
					<tr>
						<td>{{inc $idx}}</td>
						<td>
							<div class="checkbox checkbox-inline checkbox-success">
								<input type="checkbox" class="chkSelect" id="chk{{$idx}}" name="sel_{{$bill.Name}}" checked="checked">
								<label class="lblFieldName" for="chk{{$idx}}">{{.Name}}</label>
							</div>
						</td>
						<td class="tdTables">
						{{$bill.Tables|csv}}
						</td>
					</tr>
				{{end}}
				</tbody>
			</table>
			<div id="divError" class="alert alert-danger" role="alert" style="display:none"></div>
		</div>
		<div class="panel-footer">
			<button id="btnOk" type="submit" class="btn btn-primary"><i class="fa fa-check"></i> 导出</button>
		</div>
	</div>
</div>

</form>
<script>
$("#tabBill tbody .chkSelect").change(function(){
	if($(this).prop("checked")){
		$(this).closest("tr").removeClass("text-muted");
	}else{
		$(this).closest("tr").addClass("text-muted");
	}
});
$(".modal").modal({backdrop:"static"});

$("form").submit(function(){
	$("#tabBill tbody>tr").removeClass("has-error");
	$("#divError").hide();
	var error = false;
	if(!$("#tabBill tbody>tr .chkSelect").is(":checked")){
		$("#divError").html("没有选择导入的单据");
		error=true;
		$("#divError").show();
	}
	return !error;
})
</script>